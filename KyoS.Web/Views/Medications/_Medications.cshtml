@model KyoS.Web.Models.MedicationViewModel

<div class="col-md-12">
    <div class="col-md-4">
        <label asp-for="Client.Name" class="control-label">Client Name</label>
        <input asp-for="Client.Name" class="form-control" readonly />
        <span asp-validation-for="Client.Name" class="text-danger"></span>
    </div>
    <div class="col-md-4">
        <label asp-for="Client.Code" class="control-label"></label>
        <input asp-for="Client.Code" class="form-control" readonly />
        <span asp-validation-for="Client.Code" class="text-danger"></span>
    </div>
    <div class="col-md-4">
        <label asp-for="Prescriber" class="control-label"></label>
        <input asp-for="Prescriber" class="form-control" readonly />
        <span asp-validation-for="Prescriber" class="text-danger"></span><br />
    </div>
</div>

<div class="col-md-12">
    <div class="col-md-4">
        <label asp-for="Name" class="control-label">Drug Name</label>&nbsp;*
        <input asp-for="Name" class="form-control" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>
    <div class="col-md-4">
        <label asp-for="Dosage" class="control-label"></label>&nbsp;*
        <input asp-for="Dosage" class="form-control" />
        <span asp-validation-for="Dosage" class="text-danger"></span>
    </div>
    <div class="col-md-4">
        <label asp-for="Frequency" class="control-label"></label>&nbsp;*
        <input asp-for="Frequency" class="form-control" />
        <span asp-validation-for="Frequency" class="text-danger"></span><br /><br />
    </div>
</div>
<div class="col-md-12">
    <div class="col-md-12">
        <div class="panel panel-default col-md-12">
            <div class="panel-heading">
                <h3 class="panel-title">Medication List</h3>
            </div>
            <div class="panel-body">
                <table class="table table-hover table-responsive table-striped" id="MyTable">
                    <thead>
                        <tr>
                            <th class="col-md-3">
                                Drug Name
                            </th>
                            <th class="col-md-2">
                                @Html.DisplayNameFor(model => model.Dosage)
                            </th>
                            <th class="col-md-2" style="text-align:center;">
                                @Html.DisplayNameFor(model => model.Frequency)
                            </th>
                            <th class="col-md-3" style="text-align:center;">
                                @Html.DisplayNameFor(model => model.Prescriber)
                            </th>
                            <th class="col-md-1" style="text-align:center;">

                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Client.MedicationList)
                        {
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Name)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Dosage)
                                </td>
                                <td align="center">
                                    @Html.DisplayFor(modelItem => item.Frequency)
                                </td>
                                <td align="center">
                                    @Html.DisplayFor(modelItem => item.Prescriber)
                                </td>
                                <td align="center">
                                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-warning" title="Add Medication"><i class="glyphicon glyphicon-pencil"></i></a>
                                    @if (Model.Id == 0)
                                    {
                                        <button data-id="@item.Id" class="btn btn-danger deleteItem" data-toggle="modal" data-target="#deleteDialog" title="Delete Medication"><i class="glyphicon glyphicon-trash"></i></button>
                                    }

                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>
<div class="col-md-12">
    &nbsp;
</div>
<partial name="_DeleteDialog" />

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script src="~/js/jquery.dataTables.min.js"></script>

    <script type="text/javascript">
                        $(document).ready(function () {
                            $('#MyTable').DataTable({
                                "order": [[0, "asc"]],
                                "pageLength": 100
                            });

                            // Delete item
                            var item_to_delete;

                            $('.deleteItem').click((e) => {
                                item_to_delete = e.currentTarget.dataset.id;
                            });

                            $("#btnYesDelete").click(function () {
                                var url = "@Url.Action("Delete", "Medications")";
                                window.location.href = url + '/' + item_to_delete;
                            });
                        });
    </script>
}








